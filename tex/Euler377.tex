\documentclass[a4paper,12pt]{article}
\usepackage{amsmath}
\usepackage{amssymb}
\begin{document}
\setlength\parindent{0pt}
\textbf{Project Euler 377}
\vspace{5ex}

For \(n \geq 1\) let \(C_n = \{m \in \mathbb{N} \mid m\) has no zero in its digits and sum of its digits is \(n\}\) be our inspected constraint. We define \(f_n = f(n) = \sum_{c \in C_n} c\) and \(g_n = |C_n|\). Initial values of these sequences are:

\(
\begin{tabular}{|l|l|l|l|l|l|l|l|l|l|}
\hline
\(n\) & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\ \hline
\(f_n\) & 1 & 13 & 147 & 1625 & 17891 & 196833 & 2165227 & 23817625 & 261994131 \\ \hline
\(g_n\) & 1 & 2 & 4 & 8 & 16 & 32 & 64 & 128 & 256 \\ \hline
\end{tabular}
\)

For \(n \geq 10\) we have recursive formulas:
\[f_n = \sum_{i = 1}^9 10f_{n - i} + ig_{n - i}\]
\[g_n = \sum_{i = 1}^9 g_{n - i}\]
and that's because
\[C_n = \bigsqcup_{i = 1}^9 \{10d + i \mid d \in C_{n - i}\}\]

To compute desired values of \(f\) fast, we can build matrix \(A\) such that

\[A
\begin{bmatrix}
f_{n} \\
f_{n - 1} \\
\vdots \\
f_{n - 8} \\
g_{n} \\
g_{n - 1} \\
\vdots \\
g_{n - 8}
\end{bmatrix}
=
\begin{bmatrix}
f_{n + 1} \\
f_{n} \\
\vdots \\
f_{n - 7} \\
g_{n + 1} \\
g_{n} \\
\vdots \\
g_{n - 7}
\end{bmatrix} \]

and use fast exponentiation algorithm.
\end{document}